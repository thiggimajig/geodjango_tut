<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=emulateIE7" />
    <title>Coverage for world/policy_functions.py: 22%</title>
    <link rel="stylesheet" href="style.css" type="text/css">
    <script type="text/javascript" src="jquery.min.js"></script>
    <script type="text/javascript" src="jquery.hotkeys.js"></script>
    <script type="text/javascript" src="jquery.isonscreen.js"></script>
    <script type="text/javascript" src="coverage_html.js"></script>
    <script type="text/javascript">
        jQuery(document).ready(coverage.pyfile_ready);
    </script>
</head>
<body class="pyfile">
<div id="header">
    <div class="content">
        <h1>Coverage for <b>world/policy_functions.py</b> :
            <span class="pc_cov">22%</span>
        </h1>
        <img id="keyboard_icon" src="keybd_closed.png" alt="Show keyboard shortcuts" />
        <h2 class="stats">
            129 statements &nbsp;
            <button type="button" class="run shortkey_r button_toggle_run" title="Toggle lines run">29 run</button>
            <button type="button" class="mis show_mis shortkey_m button_toggle_mis" title="Toggle lines missing">100 missing</button>
            <button type="button" class="exc show_exc shortkey_x button_toggle_exc" title="Toggle lines excluded">0 excluded</button>
        </h2>
    </div>
</div>
<div class="help_panel">
    <img id="panel_icon" src="keybd_open.png" alt="Hide keyboard shortcuts" />
    <p class="legend">Hot-keys on this page</p>
    <div>
    <p class="keyhelp">
        <span class="key">r</span>
        <span class="key">m</span>
        <span class="key">x</span>
        <span class="key">p</span> &nbsp; toggle line displays
    </p>
    <p class="keyhelp">
        <span class="key">j</span>
        <span class="key">k</span> &nbsp; next/prev highlighted chunk
    </p>
    <p class="keyhelp">
        <span class="key">0</span> &nbsp; (zero) top of page
    </p>
    <p class="keyhelp">
        <span class="key">1</span> &nbsp; (one) first highlighted chunk
    </p>
    </div>
</div>
<div id="source">
    <p id="t1" class="run"><span class="n"><a href="#t1">1</a></span><span class="t"><span class="key">import</span> <span class="nam">geojson</span>&nbsp;</span><span class="r"></span></p>
    <p id="t2" class="pln"><span class="n"><a href="#t2">2</a></span><span class="t"><span class="com"># import geopandas</span>&nbsp;</span><span class="r"></span></p>
    <p id="t3" class="run"><span class="n"><a href="#t3">3</a></span><span class="t"><span class="key">import</span> <span class="nam">pandas</span> <span class="key">as</span> <span class="nam">pd</span>&nbsp;</span><span class="r"></span></p>
    <p id="t4" class="run"><span class="n"><a href="#t4">4</a></span><span class="t"><span class="key">import</span> <span class="nam">numpy</span> <span class="key">as</span> <span class="nam">np</span>&nbsp;</span><span class="r"></span></p>
    <p id="t5" class="run"><span class="n"><a href="#t5">5</a></span><span class="t"><span class="key">import</span> <span class="nam">statistics</span> <span class="key">as</span> <span class="nam">st</span>&nbsp;</span><span class="r"></span></p>
    <p id="t6" class="run"><span class="n"><a href="#t6">6</a></span><span class="t"><span class="key">import</span> <span class="nam">matplotlib</span> <span class="key">as</span> <span class="nam">plt</span>&nbsp;</span><span class="r"></span></p>
    <p id="t7" class="run"><span class="n"><a href="#t7">7</a></span><span class="t"><span class="key">import</span> <span class="nam">folium</span>&nbsp;</span><span class="r"></span></p>
    <p id="t8" class="run"><span class="n"><a href="#t8">8</a></span><span class="t"><span class="key">from</span> <span class="nam">folium</span><span class="op">.</span><span class="nam">features</span> <span class="key">import</span> <span class="nam">CustomIcon</span>&nbsp;</span><span class="r"></span></p>
    <p id="t9" class="run"><span class="n"><a href="#t9">9</a></span><span class="t"><span class="key">import</span> <span class="nam">csv</span>&nbsp;</span><span class="r"></span></p>
    <p id="t10" class="run"><span class="n"><a href="#t10">10</a></span><span class="t"><span class="key">from</span> <span class="nam">IPython</span><span class="op">.</span><span class="nam">display</span> <span class="key">import</span> <span class="nam">display</span><span class="op">,</span> <span class="nam">HTML</span>&nbsp;</span><span class="r"></span></p>
    <p id="t11" class="run"><span class="n"><a href="#t11">11</a></span><span class="t"><span class="key">from</span> <span class="nam">pathlib</span> <span class="key">import</span> <span class="nam">Path</span>&nbsp;</span><span class="r"></span></p>
    <p id="t12" class="run"><span class="n"><a href="#t12">12</a></span><span class="t"><span class="key">import</span> <span class="nam">os</span>&nbsp;</span><span class="r"></span></p>
    <p id="t13" class="run"><span class="n"><a href="#t13">13</a></span><span class="t"><span class="key">import</span> <span class="nam">sys</span>&nbsp;</span><span class="r"></span></p>
    <p id="t14" class="run"><span class="n"><a href="#t14">14</a></span><span class="t"><span class="nam">data_path</span> <span class="op">=</span> <span class="nam">os</span><span class="op">.</span><span class="nam">path</span><span class="op">.</span><span class="nam">abspath</span><span class="op">(</span><span class="str">'/Users/stateofplace/new_codes/geodjango_tut/geodjango/world/data/'</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p id="t15" class="run"><span class="n"><a href="#t15">15</a></span><span class="t"><span class="nam">sys</span><span class="op">.</span><span class="nam">path</span><span class="op">.</span><span class="nam">append</span><span class="op">(</span><span class="nam">data_path</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p id="t16" class="pln"><span class="n"><a href="#t16">16</a></span><span class="t"><span class="com"># sys.path.append("/geodjango/world/data/policy_functions")</span>&nbsp;</span><span class="r"></span></p>
    <p id="t17" class="pln"><span class="n"><a href="#t17">17</a></span><span class="t"><span class="com">#example of absolute path settting for file... </span>&nbsp;</span><span class="r"></span></p>
    <p id="t18" class="pln"><span class="n"><a href="#t18">18</a></span><span class="t"><span class="com"># dirpath = os.path.dirname(os.path.abspath(__file__))</span>&nbsp;</span><span class="r"></span></p>
    <p id="t19" class="pln"><span class="n"><a href="#t19">19</a></span><span class="t"><span class="com"># chap_dirpath = os.path.join(dirpath, chap_dirpath)</span>&nbsp;</span><span class="r"></span></p>
    <p id="t20" class="pln"><span class="n"><a href="#t20">20</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p id="t21" class="run"><span class="n"><a href="#t21">21</a></span><span class="t"><span class="nam">esri</span> <span class="op">=</span> <span class="str">'https://server.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer/tile/{z}/{y}/{x}'</span>&nbsp;</span><span class="r"></span></p>
    <p id="t22" class="run"><span class="n"><a href="#t22">22</a></span><span class="t"><span class="nam">attrib</span> <span class="op">=</span> <span class="str">'Tiles &amp;copy; Esri &amp;mdash; Esri, DeLorme, NAVTEQ, TomTom, Intermap, iPC, USGS, FAO, NPS, NRCAN, GeoBase, Kadaster NL, Ordnance Survey, Esri Japan, METI, Esri China (Hong Kong), and the GIS User Community'</span>&nbsp;</span><span class="r"></span></p>
    <p id="t23" class="pln"><span class="n"><a href="#t23">23</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p id="t24" class="pln"><span class="n"><a href="#t24">24</a></span><span class="t"><span class="com">#load up csv file into df</span>&nbsp;</span><span class="r"></span></p>
    <p id="t25" class="run"><span class="n"><a href="#t25">25</a></span><span class="t"><span class="key">def</span> <span class="nam">load_csv_data</span><span class="op">(</span><span class="nam">ia</span><span class="op">)</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p id="t26" class="mis show_mis"><span class="n"><a href="#t26">26</a></span><span class="t">    <span class="nam">ia_df</span> <span class="op">=</span> <span class="nam">pd</span><span class="op">.</span><span class="nam">read_csv</span><span class="op">(</span><span class="nam">ia</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p id="t27" class="mis show_mis"><span class="n"><a href="#t27">27</a></span><span class="t">    <span class="key">return</span> <span class="nam">ia_df</span>&nbsp;</span><span class="r"></span></p>
    <p id="t28" class="pln"><span class="n"><a href="#t28">28</a></span><span class="t"><span class="com"># df = load_csv_data(data_path + 'csv_ia/test_file.csv')</span>&nbsp;</span><span class="r"></span></p>
    <p id="t29" class="pln"><span class="n"><a href="#t29">29</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p id="t30" class="run"><span class="n"><a href="#t30">30</a></span><span class="t"><span class="key">def</span> <span class="nam">clean_dataframe</span><span class="op">(</span><span class="nam">s</span><span class="op">)</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p id="t31" class="mis show_mis"><span class="n"><a href="#t31">31</a></span><span class="t">    <span class="nam">columns_df0</span> <span class="op">=</span> <span class="op">[</span><span class="str">'id'</span><span class="op">,</span> <span class="str">'has_liscense'</span><span class="op">,</span> <span class="str">'days_rented'</span><span class="op">,</span> <span class="str">'rounded_revenue'</span><span class="op">,</span> <span class="str">'price'</span><span class="op">,</span> <span class="str">'name'</span><span class="op">,</span> <span class="str">'host_id'</span><span class="op">,</span> <span class="str">'bedrooms'</span><span class="op">,</span> <span class="str">'many_listings'</span><span class="op">,</span> <span class="str">'availability_365'</span><span class="op">,</span> <span class="str">'is_hotel'</span><span class="op">,</span> <span class="str">'host_name'</span><span class="op">,</span> <span class="str">'commercial'</span><span class="op">,</span> <span class="str">'is_entire'</span><span class="op">,</span> <span class="str">'latitude'</span><span class="op">,</span> <span class="str">'longitude'</span><span class="op">]</span>&nbsp;</span><span class="r"></span></p>
    <p id="t32" class="mis show_mis"><span class="n"><a href="#t32">32</a></span><span class="t">    <span class="nam">cleaned_df</span> <span class="op">=</span> <span class="nam">s</span><span class="op">.</span><span class="nam">loc</span><span class="op">[</span><span class="op">:</span><span class="op">,</span><span class="nam">columns_df0</span><span class="op">]</span>&nbsp;</span><span class="r"></span></p>
    <p id="t33" class="mis show_mis"><span class="n"><a href="#t33">33</a></span><span class="t">    <span class="key">return</span> <span class="nam">cleaned_df</span>&nbsp;</span><span class="r"></span></p>
    <p id="t34" class="pln"><span class="n"><a href="#t34">34</a></span><span class="t"><span class="com"># df0 = clean_dataframe(df)</span>&nbsp;</span><span class="r"></span></p>
    <p id="t35" class="pln"><span class="n"><a href="#t35">35</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p id="t36" class="run"><span class="n"><a href="#t36">36</a></span><span class="t"><span class="key">def</span> <span class="nam">create_specific_dataframes</span><span class="op">(</span><span class="nam">s</span><span class="op">)</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p id="t37" class="pln"><span class="n"><a href="#t37">37</a></span><span class="t">    <span class="com">#policy1 df</span>&nbsp;</span><span class="r"></span></p>
    <p id="t38" class="mis show_mis"><span class="n"><a href="#t38">38</a></span><span class="t">    <span class="nam">no_lisc_df0</span> <span class="op">=</span> <span class="op">(</span><span class="nam">s</span><span class="op">.</span><span class="nam">loc</span><span class="op">[</span><span class="nam">s</span><span class="op">[</span><span class="str">'has_liscense'</span><span class="op">]</span> <span class="op">==</span> <span class="num">0</span><span class="op">]</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p id="t39" class="mis show_mis"><span class="n"><a href="#t39">39</a></span><span class="t">    <span class="nam">lisc_df0</span> <span class="op">=</span> <span class="op">(</span><span class="nam">s</span><span class="op">.</span><span class="nam">loc</span><span class="op">[</span><span class="nam">s</span><span class="op">[</span><span class="str">'has_liscense'</span><span class="op">]</span> <span class="op">==</span> <span class="num">1</span><span class="op">]</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p id="t40" class="pln"><span class="n"><a href="#t40">40</a></span><span class="t">    <span class="com">#policy1 comm df</span>&nbsp;</span><span class="r"></span></p>
    <p id="t41" class="mis show_mis"><span class="n"><a href="#t41">41</a></span><span class="t">    <span class="nam">comm_no_lisc_df0</span> <span class="op">=</span> <span class="op">(</span><span class="nam">no_lisc_df0</span><span class="op">.</span><span class="nam">loc</span><span class="op">[</span><span class="nam">no_lisc_df0</span><span class="op">[</span><span class="str">'commercial'</span><span class="op">]</span> <span class="op">==</span> <span class="num">1</span><span class="op">]</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p id="t42" class="mis show_mis"><span class="n"><a href="#t42">42</a></span><span class="t">    <span class="nam">nocomm_no_lisc_df0</span> <span class="op">=</span> <span class="op">(</span><span class="nam">no_lisc_df0</span><span class="op">.</span><span class="nam">loc</span><span class="op">[</span><span class="nam">no_lisc_df0</span><span class="op">[</span><span class="str">'commercial'</span><span class="op">]</span> <span class="op">==</span> <span class="num">0</span><span class="op">]</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p id="t43" class="pln"><span class="n"><a href="#t43">43</a></span><span class="t">    <span class="com">#policy2 df</span>&nbsp;</span><span class="r"></span></p>
    <p id="t44" class="mis show_mis"><span class="n"><a href="#t44">44</a></span><span class="t">    <span class="nam">entire_df0</span> <span class="op">=</span> <span class="op">(</span><span class="nam">s</span><span class="op">.</span><span class="nam">loc</span><span class="op">[</span><span class="nam">s</span><span class="op">[</span><span class="str">'is_entire'</span><span class="op">]</span> <span class="op">==</span> <span class="num">1</span><span class="op">]</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p id="t45" class="mis show_mis"><span class="n"><a href="#t45">45</a></span><span class="t">    <span class="nam">not_entire_df0</span> <span class="op">=</span> <span class="op">(</span><span class="nam">s</span><span class="op">.</span><span class="nam">loc</span><span class="op">[</span><span class="nam">s</span><span class="op">[</span><span class="str">'is_entire'</span><span class="op">]</span> <span class="op">==</span> <span class="num">0</span><span class="op">]</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p id="t46" class="pln"><span class="n"><a href="#t46">46</a></span><span class="t">    <span class="com">#policy3 df</span>&nbsp;</span><span class="r"></span></p>
    <p id="t47" class="mis show_mis"><span class="n"><a href="#t47">47</a></span><span class="t">    <span class="nam">many_listings_df0</span> <span class="op">=</span> <span class="op">(</span><span class="nam">s</span><span class="op">.</span><span class="nam">loc</span><span class="op">[</span><span class="nam">s</span><span class="op">[</span><span class="str">'many_listings'</span><span class="op">]</span> <span class="op">==</span> <span class="num">1</span><span class="op">]</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p id="t48" class="mis show_mis"><span class="n"><a href="#t48">48</a></span><span class="t">    <span class="nam">not_many_listings_df0</span> <span class="op">=</span> <span class="op">(</span><span class="nam">s</span><span class="op">.</span><span class="nam">loc</span><span class="op">[</span><span class="nam">s</span><span class="op">[</span><span class="str">'many_listings'</span><span class="op">]</span> <span class="op">==</span> <span class="num">0</span><span class="op">]</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p id="t49" class="pln"><span class="n"><a href="#t49">49</a></span><span class="t">    <span class="com">#policy4 df #needs to be better, not just available, has to also be frequently used... but to get frequently used have to see if new or old, new use last month, old use last year pre and post covid </span>&nbsp;</span><span class="r"></span></p>
    <p id="t50" class="mis show_mis"><span class="n"><a href="#t50">50</a></span><span class="t">    <span class="nam">cap_days_df0</span> <span class="op">=</span> <span class="op">(</span><span class="nam">s</span><span class="op">.</span><span class="nam">loc</span><span class="op">[</span><span class="nam">s</span><span class="op">[</span><span class="str">'availability_365'</span><span class="op">]</span> <span class="op">></span> <span class="num">90</span><span class="op">]</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p id="t51" class="mis show_mis"><span class="n"><a href="#t51">51</a></span><span class="t">    <span class="nam">not_cap_days_df0</span> <span class="op">=</span> <span class="op">(</span><span class="nam">s</span><span class="op">.</span><span class="nam">loc</span><span class="op">[</span><span class="nam">s</span><span class="op">[</span><span class="str">'availability_365'</span><span class="op">]</span> <span class="op">&lt;</span> <span class="num">90</span><span class="op">]</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p id="t52" class="mis show_mis"><span class="n"><a href="#t52">52</a></span><span class="t">    <span class="key">return</span> <span class="nam">no_lisc_df0</span><span class="op">,</span> <span class="nam">lisc_df0</span><span class="op">,</span> <span class="nam">comm_no_lisc_df0</span><span class="op">,</span> <span class="nam">nocomm_no_lisc_df0</span><span class="op">,</span> <span class="nam">entire_df0</span><span class="op">,</span> <span class="nam">not_entire_df0</span><span class="op">,</span> <span class="nam">many_listings_df0</span><span class="op">,</span> <span class="nam">not_many_listings_df0</span><span class="op">,</span> <span class="nam">cap_days_df0</span><span class="op">,</span> <span class="nam">not_cap_days_df0</span>&nbsp;</span><span class="r"></span></p>
    <p id="t53" class="pln"><span class="n"><a href="#t53">53</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p id="t54" class="pln"><span class="n"><a href="#t54">54</a></span><span class="t"><span class="com"># policy1_df0, policy1_df0_inverse, policy1_df0_comm, policy1_df0_nocomm, policy2_df0, policy2_df0_inverse, policy3_df0, policy3_df0_inverse, policy4_df0, policy4_df0_inverse = create_specific_dataframes(df0)</span>&nbsp;</span><span class="r"></span></p>
    <p id="t55" class="pln"><span class="n"><a href="#t55">55</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p id="t56" class="run"><span class="n"><a href="#t56">56</a></span><span class="t"><span class="key">def</span> <span class="nam">stats</span><span class="op">(</span><span class="nam">dataframe</span><span class="op">)</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p id="t57" class="pln"><span class="n"><a href="#t57">57</a></span><span class="t">    <span class="com">#calculate stats for given area before any regulation</span>&nbsp;</span><span class="r"></span></p>
    <p id="t58" class="mis show_mis"><span class="n"><a href="#t58">58</a></span><span class="t">    <span class="nam">fi_stats</span> <span class="op">=</span> <span class="op">[</span><span class="op">]</span>&nbsp;</span><span class="r"></span></p>
    <p id="t59" class="mis show_mis"><span class="n"><a href="#t59">59</a></span><span class="t">    <span class="nam">count_of_listings</span> <span class="op">=</span> <span class="nam">dataframe</span><span class="op">.</span><span class="nam">shape</span><span class="op">[</span><span class="num">0</span><span class="op">]</span>&nbsp;</span><span class="r"></span></p>
    <p id="t60" class="mis show_mis"><span class="n"><a href="#t60">60</a></span><span class="t">    <span class="nam">count_of_bedrooms</span> <span class="op">=</span> <span class="nam">dataframe</span><span class="op">[</span><span class="str">'bedrooms'</span><span class="op">]</span><span class="op">.</span><span class="nam">agg</span><span class="op">(</span><span class="str">'sum'</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p id="t61" class="mis show_mis"><span class="n"><a href="#t61">61</a></span><span class="t">    <span class="nam">fi_stats</span><span class="op">.</span><span class="nam">append</span><span class="op">(</span><span class="nam">count_of_listings</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p id="t62" class="mis show_mis"><span class="n"><a href="#t62">62</a></span><span class="t">    <span class="nam">fi_stats</span><span class="op">.</span><span class="nam">append</span><span class="op">(</span><span class="nam">count_of_bedrooms</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p id="t63" class="pln"><span class="n"><a href="#t63">63</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p id="t64" class="mis show_mis"><span class="n"><a href="#t64">64</a></span><span class="t">    <span class="key">return</span> <span class="nam">fi_stats</span>&nbsp;</span><span class="r"></span></p>
    <p id="t65" class="pln"><span class="n"><a href="#t65">65</a></span><span class="t"><span class="com"># basic_stats_df0 = stats(df0)</span>&nbsp;</span><span class="r"></span></p>
    <p id="t66" class="pln"><span class="n"><a href="#t66">66</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p id="t67" class="run"><span class="n"><a href="#t67">67</a></span><span class="t"><span class="key">def</span> <span class="nam">updated_stats</span><span class="op">(</span><span class="nam">datadf</span><span class="op">,</span> <span class="nam">datadfinverse</span><span class="op">)</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p id="t68" class="mis show_mis"><span class="n"><a href="#t68">68</a></span><span class="t">    <span class="nam">count_listings_effected</span> <span class="op">=</span> <span class="nam">datadf</span><span class="op">.</span><span class="nam">shape</span><span class="op">[</span><span class="num">0</span><span class="op">]</span>&nbsp;</span><span class="r"></span></p>
    <p id="t69" class="mis show_mis"><span class="n"><a href="#t69">69</a></span><span class="t">    <span class="nam">count_listings_not_effected</span> <span class="op">=</span> <span class="nam">datadfinverse</span><span class="op">.</span><span class="nam">shape</span><span class="op">[</span><span class="num">0</span><span class="op">]</span>&nbsp;</span><span class="r"></span></p>
    <p id="t70" class="mis show_mis"><span class="n"><a href="#t70">70</a></span><span class="t">    <span class="key">return</span> <span class="nam">count_listings_effected</span><span class="op">,</span> <span class="nam">count_listings_not_effected</span>&nbsp;</span><span class="r"></span></p>
    <p id="t71" class="pln"><span class="n"><a href="#t71">71</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p id="t72" class="run"><span class="n"><a href="#t72">72</a></span><span class="t"><span class="key">def</span> <span class="nam">ltr_stats</span><span class="op">(</span><span class="nam">datadf</span><span class="op">)</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p id="t73" class="pln"><span class="n"><a href="#t73">73</a></span><span class="t">    <span class="com"># entire units LTR, bedroom count LTR </span>&nbsp;</span><span class="r"></span></p>
    <p id="t74" class="mis show_mis"><span class="n"><a href="#t74">74</a></span><span class="t">    <span class="nam">returned_units_entire</span> <span class="op">=</span> <span class="nam">datadf</span><span class="op">.</span><span class="nam">loc</span><span class="op">[</span><span class="nam">datadf</span><span class="op">[</span><span class="str">'is_entire'</span><span class="op">]</span><span class="op">==</span><span class="num">1</span><span class="op">]</span><span class="op">.</span><span class="nam">shape</span><span class="op">[</span><span class="num">0</span><span class="op">]</span>&nbsp;</span><span class="r"></span></p>
    <p id="t75" class="mis show_mis"><span class="n"><a href="#t75">75</a></span><span class="t">    <span class="nam">returned_units_bedrooms</span> <span class="op">=</span> <span class="nam">datadf</span><span class="op">[</span><span class="str">'bedrooms'</span><span class="op">]</span><span class="op">.</span><span class="nam">agg</span><span class="op">(</span><span class="str">'sum'</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p id="t76" class="mis show_mis"><span class="n"><a href="#t76">76</a></span><span class="t">    <span class="key">return</span> <span class="nam">returned_units_entire</span><span class="op">,</span> <span class="nam">returned_units_bedrooms</span>&nbsp;</span><span class="r"></span></p>
    <p id="t77" class="pln"><span class="n"><a href="#t77">77</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p id="t78" class="pln"><span class="n"><a href="#t78">78</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p id="t79" class="run"><span class="n"><a href="#t79">79</a></span><span class="t"><span class="key">def</span> <span class="nam">feetax_stats</span><span class="op">(</span><span class="nam">datadf</span><span class="op">,</span> <span class="nam">datadfcomm</span><span class="op">,</span> <span class="nam">datadfnocomm</span><span class="op">)</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p id="t80" class="pln"><span class="n"><a href="#t80">80</a></span><span class="t">    <span class="com">#fees </span>&nbsp;</span><span class="r"></span></p>
    <p id="t81" class="mis show_mis"><span class="n"><a href="#t81">81</a></span><span class="t">    <span class="nam">feestats</span> <span class="op">=</span> <span class="op">[</span><span class="op">]</span>&nbsp;</span><span class="r"></span></p>
    <p id="t82" class="pln"><span class="n"><a href="#t82">82</a></span><span class="t">    <span class="com"># -non comm fee collection (count based on other cities)</span>&nbsp;</span><span class="r"></span></p>
    <p id="t83" class="mis show_mis"><span class="n"><a href="#t83">83</a></span><span class="t">    <span class="nam">yearly_fee_nolisc</span> <span class="op">=</span> <span class="op">(</span><span class="nam">datadfnocomm</span><span class="op">.</span><span class="nam">shape</span><span class="op">[</span><span class="num">0</span><span class="op">]</span> <span class="op">*</span> <span class="num">30</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p id="t84" class="pln"><span class="n"><a href="#t84">84</a></span><span class="t">    <span class="com"># -commercial fee collection&#160;</span>&nbsp;</span><span class="r"></span></p>
    <p id="t85" class="mis show_mis"><span class="n"><a href="#t85">85</a></span><span class="t">    <span class="nam">yearly_fee_nolis_comm</span> <span class="op">=</span> <span class="op">(</span><span class="nam">datadfcomm</span><span class="op">.</span><span class="nam">shape</span><span class="op">[</span><span class="num">0</span><span class="op">]</span> <span class="op">*</span> <span class="num">60</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p id="t86" class="mis show_mis"><span class="n"><a href="#t86">86</a></span><span class="t">    <span class="nam">yearly_fee_tot</span> <span class="op">=</span> <span class="nam">yearly_fee_nolisc</span> <span class="op">+</span> <span class="nam">yearly_fee_nolis_comm</span>&nbsp;</span><span class="r"></span></p>
    <p id="t87" class="pln"><span class="n"><a href="#t87">87</a></span><span class="t">    <span class="com">#taxes </span>&nbsp;</span><span class="r"></span></p>
    <p id="t88" class="pln"><span class="n"><a href="#t88">88</a></span><span class="t">    <span class="com"># -tax rev increase normal 21% for all </span>&nbsp;</span><span class="r"></span></p>
    <p id="t89" class="pln"><span class="n"><a href="#t89">89</a></span><span class="t">    <span class="com"># yearly_revenue_nolisc = datadf['rounded_re'].agg('sum')</span>&nbsp;</span><span class="r"></span></p>
    <p id="t90" class="mis show_mis"><span class="n"><a href="#t90">90</a></span><span class="t">    <span class="nam">yearly_revenue_nolisc</span> <span class="op">=</span> <span class="nam">datadf</span><span class="op">[</span><span class="str">'rounded_revenue'</span><span class="op">]</span><span class="op">.</span><span class="nam">agg</span><span class="op">(</span><span class="str">'sum'</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p id="t91" class="mis show_mis"><span class="n"><a href="#t91">91</a></span><span class="t">    <span class="nam">yearly_increased_tax_rev_21</span> <span class="op">=</span> <span class="nam">yearly_revenue_nolisc</span> <span class="op">*</span> <span class="num">.21</span>&nbsp;</span><span class="r"></span></p>
    <p id="t92" class="pln"><span class="n"><a href="#t92">92</a></span><span class="t">    <span class="com"># # -tax rev increase normal 30% -tax increase commercial 60% </span>&nbsp;</span><span class="r"></span></p>
    <p id="t93" class="pln"><span class="n"><a href="#t93">93</a></span><span class="t">    <span class="com"># yearly_rev_nolisc_comm = datadfcomm['rounded_re'].agg('sum')</span>&nbsp;</span><span class="r"></span></p>
    <p id="t94" class="pln"><span class="n"><a href="#t94">94</a></span><span class="t">    <span class="com"># yearly_rev_nolisc_nocomm = datadfnocomm['rounded_re'].agg('sum')</span>&nbsp;</span><span class="r"></span></p>
    <p id="t95" class="mis show_mis"><span class="n"><a href="#t95">95</a></span><span class="t">    <span class="nam">yearly_rev_nolisc_comm</span> <span class="op">=</span> <span class="nam">datadfcomm</span><span class="op">[</span><span class="str">'rounded_revenue'</span><span class="op">]</span><span class="op">.</span><span class="nam">agg</span><span class="op">(</span><span class="str">'sum'</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p id="t96" class="mis show_mis"><span class="n"><a href="#t96">96</a></span><span class="t">    <span class="nam">yearly_rev_nolisc_nocomm</span> <span class="op">=</span> <span class="nam">datadfnocomm</span><span class="op">[</span><span class="str">'rounded_revenue'</span><span class="op">]</span><span class="op">.</span><span class="nam">agg</span><span class="op">(</span><span class="str">'sum'</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p id="t97" class="mis show_mis"><span class="n"><a href="#t97">97</a></span><span class="t">    <span class="nam">yearly_rev_nocomm</span> <span class="op">=</span> <span class="op">(</span><span class="nam">yearly_rev_nolisc_nocomm</span> <span class="op">*</span> <span class="num">.30</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p id="t98" class="mis show_mis"><span class="n"><a href="#t98">98</a></span><span class="t">    <span class="nam">yearly_rev_comm</span> <span class="op">=</span> <span class="op">(</span><span class="nam">yearly_rev_nolisc_comm</span> <span class="op">*</span> <span class="num">.60</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p id="t99" class="mis show_mis"><span class="n"><a href="#t99">99</a></span><span class="t">    <span class="nam">yearly_rev_tot</span> <span class="op">=</span> <span class="nam">yearly_rev_nocomm</span> <span class="op">+</span> <span class="nam">yearly_rev_comm</span>&nbsp;</span><span class="r"></span></p>
    <p id="t100" class="mis show_mis"><span class="n"><a href="#t100">100</a></span><span class="t">    <span class="nam">feestats</span><span class="op">.</span><span class="nam">append</span><span class="op">(</span><span class="nam">round</span><span class="op">(</span><span class="nam">yearly_fee_tot</span><span class="op">,</span><span class="num">2</span><span class="op">)</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p id="t101" class="mis show_mis"><span class="n"><a href="#t101">101</a></span><span class="t">    <span class="nam">feestats</span><span class="op">.</span><span class="nam">append</span><span class="op">(</span><span class="nam">round</span><span class="op">(</span><span class="nam">yearly_increased_tax_rev_21</span><span class="op">,</span><span class="num">2</span><span class="op">)</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p id="t102" class="mis show_mis"><span class="n"><a href="#t102">102</a></span><span class="t">    <span class="nam">feestats</span><span class="op">.</span><span class="nam">append</span><span class="op">(</span><span class="nam">round</span><span class="op">(</span><span class="nam">yearly_rev_tot</span><span class="op">,</span><span class="num">2</span><span class="op">)</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p id="t103" class="mis show_mis"><span class="n"><a href="#t103">103</a></span><span class="t">    <span class="key">return</span> <span class="nam">feestats</span>&nbsp;</span><span class="r"></span></p>
    <p id="t104" class="pln"><span class="n"><a href="#t104">104</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p id="t105" class="pln"><span class="n"><a href="#t105">105</a></span><span class="t"><span class="com"># feestats_list = feetax_stats(policy1_df0, policy1_df0_comm, policy1_df0_nocomm)</span>&nbsp;</span><span class="r"></span></p>
    <p id="t106" class="pln"><span class="n"><a href="#t106">106</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p id="t107" class="pln"><span class="n"><a href="#t107">107</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p id="t108" class="run"><span class="n"><a href="#t108">108</a></span><span class="t"><span class="key">def</span> <span class="nam">original_airbnb_map</span><span class="op">(</span><span class="nam">mapdf</span><span class="op">,</span> <span class="nam">tileinfo</span><span class="op">,</span> <span class="nam">attribinfo</span><span class="op">,</span> <span class="nam">filetitle</span><span class="op">)</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p id="t109" class="pln"><span class="n"><a href="#t109">109</a></span><span class="t">    <span class="com">#create bubble map</span>&nbsp;</span><span class="r"></span></p>
    <p id="t110" class="mis show_mis"><span class="n"><a href="#t110">110</a></span><span class="t">    <span class="nam">bub_map</span> <span class="op">=</span> <span class="nam">folium</span><span class="op">.</span><span class="nam">Map</span><span class="op">(</span><span class="nam">location</span><span class="op">=</span><span class="op">[</span><span class="nam">mapdf</span><span class="op">.</span><span class="nam">latitude</span><span class="op">.</span><span class="nam">mean</span><span class="op">(</span><span class="op">)</span><span class="op">,</span><span class="nam">mapdf</span><span class="op">.</span><span class="nam">longitude</span><span class="op">.</span><span class="nam">mean</span><span class="op">(</span><span class="op">)</span><span class="op">]</span><span class="op">,</span> <span class="nam">zoom_start</span><span class="op">=</span><span class="num">12</span><span class="op">,</span> <span class="nam">control_scale</span><span class="op">=</span><span class="key">True</span><span class="op">,</span> <span class="nam">tiles</span><span class="op">=</span><span class="nam">tileinfo</span><span class="op">,</span> <span class="nam">attr</span><span class="op">=</span><span class="nam">attribinfo</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p id="t111" class="mis show_mis"><span class="n"><a href="#t111">111</a></span><span class="t">    <span class="nam">folium</span><span class="op">.</span><span class="nam">LayerControl</span><span class="op">(</span><span class="op">)</span><span class="op">.</span><span class="nam">add_to</span><span class="op">(</span><span class="nam">bub_map</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p id="t112" class="pln"><span class="n"><a href="#t112">112</a></span><span class="t">    <span class="com"># TODO change 1 to yes and had total listings and if in florence and make more maps for commercial and not in florence </span>&nbsp;</span><span class="r"></span></p>
    <p id="t113" class="mis show_mis"><span class="n"><a href="#t113">113</a></span><span class="t">    <span class="key">for</span> <span class="nam">index</span><span class="op">,</span> <span class="nam">location_info</span> <span class="key">in</span> <span class="nam">mapdf</span><span class="op">.</span><span class="nam">iterrows</span><span class="op">(</span><span class="op">)</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p id="t114" class="mis show_mis"><span class="n"><a href="#t114">114</a></span><span class="t">        <span class="nam">folium</span><span class="op">.</span><span class="nam">CircleMarker</span><span class="op">(</span><span class="op">[</span><span class="nam">location_info</span><span class="op">[</span><span class="str">"latitude"</span><span class="op">]</span><span class="op">,</span><span class="nam">location_info</span><span class="op">[</span><span class="str">"longitude"</span><span class="op">]</span><span class="op">]</span><span class="op">,</span> <span class="nam">radius</span><span class="op">=</span><span class="num">2</span><span class="op">,</span> <span class="nam">color</span><span class="op">=</span><span class="str">"black"</span><span class="op">,</span> <span class="nam">fill</span><span class="op">=</span><span class="key">True</span><span class="op">,</span> <span class="nam">fill_color</span> <span class="op">=</span><span class="str">"black"</span><span class="op">,</span>  <span class="nam">popup</span><span class="op">=</span><span class="str">"name: &lt;br>"</span> <span class="op">+</span> <span class="nam">str</span><span class="op">(</span><span class="op">(</span><span class="nam">location_info</span><span class="op">[</span><span class="str">"name"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="str">" hostname: &lt;br> "</span> <span class="op">+</span> <span class="nam">str</span><span class="op">(</span><span class="nam">location_info</span><span class="op">[</span><span class="str">"host_name"</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span> <span class="str">" Commercial Property : &lt;br> "</span> <span class="op">+</span> <span class="nam">str</span><span class="op">(</span><span class="nam">location_info</span><span class="op">[</span><span class="str">"commercial"</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span> <span class="str">" Price: &lt;br>"</span> <span class="op">+</span> <span class="nam">str</span><span class="op">(</span><span class="nam">location_info</span><span class="op">[</span><span class="str">"price"</span><span class="op">]</span><span class="op">)</span><span class="op">,</span> <span class="nam">tooltip</span><span class="op">=</span><span class="str">"yearly revenue: "</span> <span class="op">+</span> <span class="nam">str</span><span class="op">(</span><span class="nam">location_info</span><span class="op">[</span><span class="str">"rounded_revenue"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">.</span><span class="nam">add_to</span><span class="op">(</span><span class="nam">bub_map</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p id="t115" class="mis show_mis"><span class="n"><a href="#t115">115</a></span><span class="t">    <span class="nam">bub_map</span><span class="op">.</span><span class="nam">save</span><span class="op">(</span><span class="nam">data_path</span> <span class="op">+</span> <span class="str">'/Out_Map/'</span> <span class="op">+</span> <span class="nam">filetitle</span> <span class="op">+</span> <span class="str">'.html'</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p id="t116" class="mis show_mis"><span class="n"><a href="#t116">116</a></span><span class="t">    <span class="key">return</span> <span class="nam">bub_map</span>&nbsp;</span><span class="r"></span></p>
    <p id="t117" class="pln"><span class="n"><a href="#t117">117</a></span><span class="t"><span class="com">#original_airbnb_map(mapdf, datadf, tileinfo)</span>&nbsp;</span><span class="r"></span></p>
    <p id="t118" class="pln"><span class="n"><a href="#t118">118</a></span><span class="t"><span class="com"># original_airbnb_map(df0, esri, attrib, 'original_airbnb_map')</span>&nbsp;</span><span class="r"></span></p>
    <p id="t119" class="pln"><span class="n"><a href="#t119">119</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p id="t120" class="pln"><span class="n"><a href="#t120">120</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p id="t121" class="run"><span class="n"><a href="#t121">121</a></span><span class="t"><span class="key">def</span> <span class="nam">updated_airbnb_map</span><span class="op">(</span><span class="nam">mapdf</span><span class="op">,</span> <span class="nam">datadf</span><span class="op">,</span> <span class="nam">inverse_datadf</span><span class="op">,</span> <span class="nam">tileinfo</span><span class="op">,</span> <span class="nam">attribinfo</span><span class="op">,</span> <span class="nam">filetitle</span><span class="op">)</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p id="t122" class="pln"><span class="n"><a href="#t122">122</a></span><span class="t">    <span class="com">#create updated bubble map after clicking certain policy x</span>&nbsp;</span><span class="r"></span></p>
    <p id="t123" class="mis show_mis"><span class="n"><a href="#t123">123</a></span><span class="t">    <span class="nam">updated_bub_map</span> <span class="op">=</span> <span class="nam">folium</span><span class="op">.</span><span class="nam">Map</span><span class="op">(</span><span class="nam">location</span><span class="op">=</span><span class="op">[</span><span class="nam">mapdf</span><span class="op">.</span><span class="nam">latitude</span><span class="op">.</span><span class="nam">mean</span><span class="op">(</span><span class="op">)</span><span class="op">,</span><span class="nam">mapdf</span><span class="op">.</span><span class="nam">longitude</span><span class="op">.</span><span class="nam">mean</span><span class="op">(</span><span class="op">)</span><span class="op">]</span><span class="op">,</span> <span class="nam">zoom_start</span><span class="op">=</span><span class="num">12</span><span class="op">,</span> <span class="nam">control_scale</span><span class="op">=</span><span class="key">True</span><span class="op">,</span> <span class="nam">tiles</span><span class="op">=</span><span class="nam">tileinfo</span><span class="op">,</span> <span class="nam">attr</span><span class="op">=</span><span class="nam">attribinfo</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p id="t124" class="mis show_mis"><span class="n"><a href="#t124">124</a></span><span class="t">    <span class="nam">folium</span><span class="op">.</span><span class="nam">LayerControl</span><span class="op">(</span><span class="op">)</span><span class="op">.</span><span class="nam">add_to</span><span class="op">(</span><span class="nam">updated_bub_map</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p id="t125" class="mis show_mis"><span class="n"><a href="#t125">125</a></span><span class="t">    <span class="key">for</span> <span class="nam">index</span><span class="op">,</span> <span class="nam">location_info</span> <span class="key">in</span> <span class="nam">datadf</span><span class="op">.</span><span class="nam">iterrows</span><span class="op">(</span><span class="op">)</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p id="t126" class="mis show_mis"><span class="n"><a href="#t126">126</a></span><span class="t">        <span class="nam">folium</span><span class="op">.</span><span class="nam">CircleMarker</span><span class="op">(</span><span class="op">[</span><span class="nam">location_info</span><span class="op">[</span><span class="str">"latitude"</span><span class="op">]</span><span class="op">,</span><span class="nam">location_info</span><span class="op">[</span><span class="str">"longitude"</span><span class="op">]</span><span class="op">]</span><span class="op">,</span> <span class="nam">radius</span><span class="op">=</span><span class="num">2</span><span class="op">,</span> <span class="nam">color</span><span class="op">=</span><span class="str">"crimson"</span><span class="op">,</span> <span class="nam">fill</span><span class="op">=</span><span class="key">True</span><span class="op">,</span> <span class="nam">fill_color</span> <span class="op">=</span><span class="str">"crimson"</span><span class="op">,</span>  <span class="nam">popup</span><span class="op">=</span><span class="str">"name: &lt;br>"</span> <span class="op">+</span> <span class="nam">str</span><span class="op">(</span><span class="op">(</span><span class="nam">location_info</span><span class="op">[</span><span class="str">"name"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="str">" hostname: &lt;br> "</span> <span class="op">+</span> <span class="nam">str</span><span class="op">(</span><span class="nam">location_info</span><span class="op">[</span><span class="str">"host_name"</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span> <span class="str">" Commercial Property : &lt;br> "</span> <span class="op">+</span> <span class="nam">str</span><span class="op">(</span><span class="nam">location_info</span><span class="op">[</span><span class="str">"commercial"</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span> <span class="str">" Price: &lt;br>"</span> <span class="op">+</span> <span class="nam">str</span><span class="op">(</span><span class="nam">location_info</span><span class="op">[</span><span class="str">"price"</span><span class="op">]</span><span class="op">)</span><span class="op">,</span> <span class="nam">tooltip</span><span class="op">=</span><span class="str">"yearly revenue: "</span> <span class="op">+</span> <span class="nam">str</span><span class="op">(</span><span class="nam">location_info</span><span class="op">[</span><span class="str">"rounded_revenue"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">.</span><span class="nam">add_to</span><span class="op">(</span><span class="nam">updated_bub_map</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p id="t127" class="pln"><span class="n"><a href="#t127">127</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p id="t128" class="mis show_mis"><span class="n"><a href="#t128">128</a></span><span class="t">    <span class="key">for</span> <span class="nam">index</span><span class="op">,</span> <span class="nam">location_info</span> <span class="key">in</span> <span class="nam">inverse_datadf</span><span class="op">.</span><span class="nam">iterrows</span><span class="op">(</span><span class="op">)</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p id="t129" class="mis show_mis"><span class="n"><a href="#t129">129</a></span><span class="t">        <span class="nam">folium</span><span class="op">.</span><span class="nam">CircleMarker</span><span class="op">(</span><span class="op">[</span><span class="nam">location_info</span><span class="op">[</span><span class="str">"latitude"</span><span class="op">]</span><span class="op">,</span><span class="nam">location_info</span><span class="op">[</span><span class="str">"longitude"</span><span class="op">]</span><span class="op">]</span><span class="op">,</span> <span class="nam">radius</span><span class="op">=</span><span class="num">2</span><span class="op">,</span> <span class="nam">color</span><span class="op">=</span><span class="str">"blue"</span><span class="op">,</span> <span class="nam">fill</span><span class="op">=</span><span class="key">True</span><span class="op">,</span> <span class="nam">fill_color</span> <span class="op">=</span><span class="str">"blue"</span><span class="op">,</span>  <span class="nam">popup</span><span class="op">=</span><span class="str">"name: &lt;br>"</span> <span class="op">+</span> <span class="nam">str</span><span class="op">(</span><span class="op">(</span><span class="nam">location_info</span><span class="op">[</span><span class="str">"name"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="str">" hostname: &lt;br> "</span> <span class="op">+</span> <span class="nam">str</span><span class="op">(</span><span class="nam">location_info</span><span class="op">[</span><span class="str">"host_name"</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span> <span class="str">" Commercial Property : &lt;br> "</span> <span class="op">+</span> <span class="nam">str</span><span class="op">(</span><span class="nam">location_info</span><span class="op">[</span><span class="str">"commercial"</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span> <span class="str">" Price: &lt;br>"</span> <span class="op">+</span> <span class="nam">str</span><span class="op">(</span><span class="nam">location_info</span><span class="op">[</span><span class="str">"price"</span><span class="op">]</span><span class="op">)</span><span class="op">,</span> <span class="nam">tooltip</span><span class="op">=</span><span class="str">"yearly revenue: "</span> <span class="op">+</span> <span class="nam">str</span><span class="op">(</span><span class="nam">location_info</span><span class="op">[</span><span class="str">"rounded_revenue"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">.</span><span class="nam">add_to</span><span class="op">(</span><span class="nam">updated_bub_map</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p id="t130" class="mis show_mis"><span class="n"><a href="#t130">130</a></span><span class="t">    <span class="nam">updated_bub_map</span><span class="op">.</span><span class="nam">save</span><span class="op">(</span><span class="nam">data_path</span> <span class="op">+</span> <span class="str">'/Out_Map/'</span> <span class="op">+</span> <span class="nam">filetitle</span> <span class="op">+</span> <span class="str">'.html'</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p id="t131" class="pln"><span class="n"><a href="#t131">131</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p id="t132" class="mis show_mis"><span class="n"><a href="#t132">132</a></span><span class="t">    <span class="key">return</span> <span class="nam">updated_bub_map</span>&nbsp;</span><span class="r"></span></p>
    <p id="t133" class="pln"><span class="n"><a href="#t133">133</a></span><span class="t"><span class="com"># updated_airbnb_map(df0, policy4_df0, policy4_df0_inverse, esri, attrib, 'policy4_df0_funct')</span>&nbsp;</span><span class="r"></span></p>
    <p id="t134" class="pln"><span class="n"><a href="#t134">134</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p id="t135" class="pln"><span class="n"><a href="#t135">135</a></span><span class="t"><span class="com"># Test function for module  </span>&nbsp;</span><span class="r"></span></p>
    <p id="t136" class="run"><span class="n"><a href="#t136">136</a></span><span class="t"><span class="key">def</span> <span class="nam">_test</span><span class="op">(</span><span class="op">)</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p id="t137" class="mis show_mis"><span class="n"><a href="#t137">137</a></span><span class="t">    <span class="key">pass</span>&nbsp;</span><span class="r"></span></p>
    <p id="t138" class="pln"><span class="n"><a href="#t138">138</a></span><span class="t">    <span class="com"># assert as_int('1') == 1</span>&nbsp;</span><span class="r"></span></p>
    <p id="t139" class="pln"><span class="n"><a href="#t139">139</a></span><span class="t">    <span class="com">#assert function value input equals certain expected value if function working</span>&nbsp;</span><span class="r"></span></p>
    <p id="t140" class="run"><span class="n"><a href="#t140">140</a></span><span class="t"><span class="key">def</span> <span class="nam">get_orig_map</span><span class="op">(</span><span class="op">)</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p id="t141" class="mis show_mis"><span class="n"><a href="#t141">141</a></span><span class="t">    <span class="nam">df</span> <span class="op">=</span> <span class="nam">load_csv_data</span><span class="op">(</span><span class="nam">data_path</span> <span class="op">+</span> <span class="str">'/csv_ia/test_file.csv'</span><span class="op">)</span> <span class="com">#/Users/stateofplace/new_codes/geodjango_tut/geodjango/world/test_file.csv</span>&nbsp;</span><span class="r"></span></p>
    <p id="t142" class="mis show_mis"><span class="n"><a href="#t142">142</a></span><span class="t">    <span class="nam">df0</span> <span class="op">=</span> <span class="nam">clean_dataframe</span><span class="op">(</span><span class="nam">df</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p id="t143" class="mis show_mis"><span class="n"><a href="#t143">143</a></span><span class="t">    <span class="nam">bubmap</span> <span class="op">=</span> <span class="nam">original_airbnb_map</span><span class="op">(</span><span class="nam">df0</span><span class="op">,</span> <span class="nam">esri</span><span class="op">,</span> <span class="nam">attrib</span><span class="op">,</span> <span class="str">'original_airbnb_map_script'</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p id="t144" class="mis show_mis"><span class="n"><a href="#t144">144</a></span><span class="t">    <span class="key">return</span> <span class="nam">bubmap</span>&nbsp;</span><span class="r"></span></p>
    <p id="t145" class="pln"><span class="n"><a href="#t145">145</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p id="t146" class="pln"><span class="n"><a href="#t146">146</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p id="t147" class="run"><span class="n"><a href="#t147">147</a></span><span class="t"><span class="key">def</span> <span class="nam">getbubmaps</span><span class="op">(</span><span class="op">)</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p id="t148" class="mis show_mis"><span class="n"><a href="#t148">148</a></span><span class="t">    <span class="nam">df</span> <span class="op">=</span> <span class="nam">load_csv_data</span><span class="op">(</span><span class="nam">data_path</span> <span class="op">+</span> <span class="str">'/csv_ia/test_file.csv'</span><span class="op">)</span> <span class="com">#/Users/stateofplace/new_codes/geodjango_tut/geodjango/world/test_file.csv</span>&nbsp;</span><span class="r"></span></p>
    <p id="t149" class="mis show_mis"><span class="n"><a href="#t149">149</a></span><span class="t">    <span class="nam">df0</span> <span class="op">=</span> <span class="nam">clean_dataframe</span><span class="op">(</span><span class="nam">df</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p id="t150" class="mis show_mis"><span class="n"><a href="#t150">150</a></span><span class="t">    <span class="nam">policy1_df0</span><span class="op">,</span> <span class="nam">policy1_df0_inverse</span><span class="op">,</span> <span class="nam">policy1_df0_comm</span><span class="op">,</span> <span class="nam">policy1_df0_nocomm</span><span class="op">,</span> <span class="nam">policy2_df0</span><span class="op">,</span> <span class="nam">policy2_df0_inverse</span><span class="op">,</span> <span class="nam">policy3_df0</span><span class="op">,</span> <span class="nam">policy3_df0_inverse</span><span class="op">,</span> <span class="nam">policy4_df0</span><span class="op">,</span> <span class="nam">policy4_df0_inverse</span> <span class="op">=</span> <span class="nam">create_specific_dataframes</span><span class="op">(</span><span class="nam">df0</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p id="t151" class="pln"><span class="n"><a href="#t151">151</a></span><span class="t">    <span class="com"># basic_stats_df0 = stats(df0)</span>&nbsp;</span><span class="r"></span></p>
    <p id="t152" class="pln"><span class="n"><a href="#t152">152</a></span><span class="t">    <span class="com"># feestats_list = feetax_stats(policy1_df0, policy1_df0_comm, policy1_df0_nocomm)</span>&nbsp;</span><span class="r"></span></p>
    <p id="t153" class="mis show_mis"><span class="n"><a href="#t153">153</a></span><span class="t">    <span class="nam">bubmap</span> <span class="op">=</span> <span class="nam">original_airbnb_map</span><span class="op">(</span><span class="nam">df0</span><span class="op">,</span> <span class="nam">esri</span><span class="op">,</span> <span class="nam">attrib</span><span class="op">,</span> <span class="str">'original_airbnb_map_script'</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p id="t154" class="mis show_mis"><span class="n"><a href="#t154">154</a></span><span class="t">    <span class="nam">updatedbubmap_1</span> <span class="op">=</span> <span class="nam">updated_airbnb_map</span><span class="op">(</span><span class="nam">df0</span><span class="op">,</span> <span class="nam">policy1_df0</span><span class="op">,</span> <span class="nam">policy1_df0_inverse</span><span class="op">,</span> <span class="nam">esri</span><span class="op">,</span> <span class="nam">attrib</span><span class="op">,</span> <span class="str">'policy1_df0_funct_script'</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p id="t155" class="mis show_mis"><span class="n"><a href="#t155">155</a></span><span class="t">    <span class="nam">updatedbubmap_2</span> <span class="op">=</span> <span class="nam">updated_airbnb_map</span><span class="op">(</span><span class="nam">df0</span><span class="op">,</span> <span class="nam">policy2_df0</span><span class="op">,</span> <span class="nam">policy2_df0_inverse</span><span class="op">,</span> <span class="nam">esri</span><span class="op">,</span> <span class="nam">attrib</span><span class="op">,</span> <span class="str">'policy2_df0_funct_script'</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p id="t156" class="mis show_mis"><span class="n"><a href="#t156">156</a></span><span class="t">    <span class="nam">updatedbubmap_3</span> <span class="op">=</span> <span class="nam">updated_airbnb_map</span><span class="op">(</span><span class="nam">df0</span><span class="op">,</span> <span class="nam">policy3_df0</span><span class="op">,</span> <span class="nam">policy3_df0_inverse</span><span class="op">,</span> <span class="nam">esri</span><span class="op">,</span> <span class="nam">attrib</span><span class="op">,</span> <span class="str">'policy3_df0_funct_script'</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p id="t157" class="pln"><span class="n"><a href="#t157">157</a></span><span class="t">    <span class="com"># updated_stats = updated_stats(policy1_df0, policy1_df0_inverse) </span>&nbsp;</span><span class="r"></span></p>
    <p id="t158" class="pln"><span class="n"><a href="#t158">158</a></span><span class="t">    <span class="com"># ltr_stats = ltr_stats(policy1_df0) </span>&nbsp;</span><span class="r"></span></p>
    <p id="t159" class="pln"><span class="n"><a href="#t159">159</a></span><span class="t">    <span class="com">#MUST RETURN THINGS!!!! </span>&nbsp;</span><span class="r"></span></p>
    <p id="t160" class="pln"><span class="n"><a href="#t160">160</a></span><span class="t">    <span class="com">#here we can return all the maps for all the policies etc, then in views call them by the [0]</span>&nbsp;</span><span class="r"></span></p>
    <p id="t161" class="mis show_mis"><span class="n"><a href="#t161">161</a></span><span class="t">    <span class="nam">bubmap</span> <span class="op">=</span> <span class="nam">original_airbnb_map</span><span class="op">(</span><span class="nam">df0</span><span class="op">,</span> <span class="nam">esri</span><span class="op">,</span> <span class="nam">attrib</span><span class="op">,</span> <span class="str">'original_airbnb_map_script'</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p id="t162" class="mis show_mis"><span class="n"><a href="#t162">162</a></span><span class="t">    <span class="key">return</span> <span class="nam">bubmap</span><span class="op">,</span> <span class="nam">updatedbubmap_1</span><span class="op">,</span> <span class="nam">updatedbubmap_2</span><span class="op">,</span> <span class="nam">updatedbubmap_3</span>&nbsp;</span><span class="r"></span></p>
    <p id="t163" class="pln"><span class="n"><a href="#t163">163</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p id="t164" class="run"><span class="n"><a href="#t164">164</a></span><span class="t"><span class="key">def</span> <span class="nam">popup_html</span><span class="op">(</span><span class="nam">row</span><span class="op">)</span><span class="op">:</span>&nbsp;</span><span class="r"></span></p>
    <p id="t165" class="pln"><span class="n"><a href="#t165">165</a></span><span class="t">    <span class="com"># html ="hello"  #this worked, we can do this. niente</span>&nbsp;</span><span class="r"></span></p>
    <p id="t166" class="pln"><span class="n"><a href="#t166">166</a></span><span class="t">    <span class="com"># html = row #this also worked, we can do this! i</span>&nbsp;</span><span class="r"></span></p>
    <p id="t167" class="pln"><span class="n"><a href="#t167">167</a></span><span class="t">    <span class="com"># html = row_price #this ALSO worked, we can def do this!! i.price</span>&nbsp;</span><span class="r"></span></p>
    <p id="t168" class="pln"><span class="n"><a href="#t168">168</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p id="t169" class="pln"><span class="n"><a href="#t169">169</a></span><span class="t">    <span class="com">#here we declare all variables from model</span>&nbsp;</span><span class="r"></span></p>
    <p id="t170" class="mis show_mis"><span class="n"><a href="#t170">170</a></span><span class="t">    <span class="nam">host_id</span> <span class="op">=</span> <span class="nam">row</span><span class="op">.</span><span class="nam">host_id</span> <span class="com">#dummy id #should work... row.host_id</span>&nbsp;</span><span class="r"></span></p>
    <p id="t171" class="mis show_mis"><span class="n"><a href="#t171">171</a></span><span class="t">    <span class="nam">host_name</span> <span class="op">=</span> <span class="nam">row</span><span class="op">.</span><span class="nam">host_name</span>&nbsp;</span><span class="r"></span></p>
    <p id="t172" class="mis show_mis"><span class="n"><a href="#t172">172</a></span><span class="t">    <span class="nam">host_since</span> <span class="op">=</span> <span class="nam">row</span><span class="op">.</span><span class="nam">host_since</span>&nbsp;</span><span class="r"></span></p>
    <p id="t173" class="mis show_mis"><span class="n"><a href="#t173">173</a></span><span class="t">    <span class="nam">host_location</span> <span class="op">=</span> <span class="nam">row</span><span class="op">.</span><span class="nam">host_location</span>&nbsp;</span><span class="r"></span></p>
    <p id="t174" class="mis show_mis"><span class="n"><a href="#t174">174</a></span><span class="t">    <span class="nam">license</span> <span class="op">=</span> <span class="nam">row</span><span class="op">.</span><span class="nam">license</span>&nbsp;</span><span class="r"></span></p>
    <p id="t175" class="mis show_mis"><span class="n"><a href="#t175">175</a></span><span class="t">    <span class="nam">host_total_listings_count</span> <span class="op">=</span> <span class="nam">row</span><span class="op">.</span><span class="nam">host_total_listings_count</span>&nbsp;</span><span class="r"></span></p>
    <p id="t176" class="mis show_mis"><span class="n"><a href="#t176">176</a></span><span class="t">    <span class="nam">global_total_listings</span> <span class="op">=</span> <span class="nam">row</span><span class="op">.</span><span class="nam">global_total_listings</span>&nbsp;</span><span class="r"></span></p>
    <p id="t177" class="mis show_mis"><span class="n"><a href="#t177">177</a></span><span class="t">    <span class="nam">listing_url</span> <span class="op">=</span> <span class="nam">row</span><span class="op">.</span><span class="nam">listing_url</span>&nbsp;</span><span class="r"></span></p>
    <p id="t178" class="mis show_mis"><span class="n"><a href="#t178">178</a></span><span class="t">    <span class="nam">listing_id</span> <span class="op">=</span> <span class="nam">row</span><span class="op">.</span><span class="nam">id</span>&nbsp;</span><span class="r"></span></p>
    <p id="t179" class="mis show_mis"><span class="n"><a href="#t179">179</a></span><span class="t">    <span class="nam">listing_name</span> <span class="op">=</span> <span class="nam">row</span><span class="op">.</span><span class="nam">name</span>&nbsp;</span><span class="r"></span></p>
    <p id="t180" class="mis show_mis"><span class="n"><a href="#t180">180</a></span><span class="t">    <span class="nam">neighbourhood_cleansed</span> <span class="op">=</span> <span class="nam">row</span><span class="op">.</span><span class="nam">neighbourhood_cleansed</span>&nbsp;</span><span class="r"></span></p>
    <p id="t181" class="mis show_mis"><span class="n"><a href="#t181">181</a></span><span class="t">    <span class="nam">dist_duomo</span> <span class="op">=</span> <span class="nam">round</span><span class="op">(</span><span class="nam">row</span><span class="op">.</span><span class="nam">dist_duomo</span><span class="op">)</span> <span class="com">#check if in meters or ft</span>&nbsp;</span><span class="r"></span></p>
    <p id="t182" class="mis show_mis"><span class="n"><a href="#t182">182</a></span><span class="t">    <span class="nam">room_type</span> <span class="op">=</span> <span class="nam">row</span><span class="op">.</span><span class="nam">room_type</span>&nbsp;</span><span class="r"></span></p>
    <p id="t183" class="mis show_mis"><span class="n"><a href="#t183">183</a></span><span class="t">    <span class="nam">bedrooms</span> <span class="op">=</span> <span class="nam">row</span><span class="op">.</span><span class="nam">bedrooms</span>&nbsp;</span><span class="r"></span></p>
    <p id="t184" class="mis show_mis"><span class="n"><a href="#t184">184</a></span><span class="t">    <span class="nam">accommodates</span> <span class="op">=</span> <span class="nam">row</span><span class="op">.</span><span class="nam">accommodates</span>&nbsp;</span><span class="r"></span></p>
    <p id="t185" class="mis show_mis"><span class="n"><a href="#t185">185</a></span><span class="t">    <span class="nam">rounded_revenue</span> <span class="op">=</span> <span class="nam">round</span><span class="op">(</span><span class="nam">row</span><span class="op">.</span><span class="nam">rounded_revenue</span><span class="op">,</span> <span class="num">2</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p id="t186" class="mis show_mis"><span class="n"><a href="#t186">186</a></span><span class="t">    <span class="nam">monthly_rounded_revenue</span> <span class="op">=</span> <span class="nam">round</span><span class="op">(</span><span class="op">(</span><span class="nam">rounded_revenue</span> <span class="op">/</span> <span class="num">12</span><span class="op">)</span><span class="op">,</span> <span class="num">2</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p id="t187" class="mis show_mis"><span class="n"><a href="#t187">187</a></span><span class="t">    <span class="nam">price</span> <span class="op">=</span> <span class="nam">row</span><span class="op">.</span><span class="nam">price</span>&nbsp;</span><span class="r"></span></p>
    <p id="t188" class="mis show_mis"><span class="n"><a href="#t188">188</a></span><span class="t">    <span class="nam">night_min</span> <span class="op">=</span> <span class="num">2</span> <span class="com">#dummy placeholder</span>&nbsp;</span><span class="r"></span></p>
    <p id="t189" class="mis show_mis"><span class="n"><a href="#t189">189</a></span><span class="t">    <span class="nam">days_rented</span> <span class="op">=</span> <span class="nam">round</span><span class="op">(</span><span class="nam">row</span><span class="op">.</span><span class="nam">days_rented</span><span class="op">,</span> <span class="num">2</span><span class="op">)</span>&nbsp;</span><span class="r"></span></p>
    <p id="t190" class="mis show_mis"><span class="n"><a href="#t190">190</a></span><span class="t">    <span class="nam">reviews_per_month</span> <span class="op">=</span> <span class="nam">row</span><span class="op">.</span><span class="nam">reviews_per_month</span>&nbsp;</span><span class="r"></span></p>
    <p id="t191" class="mis show_mis"><span class="n"><a href="#t191">191</a></span><span class="t">    <span class="nam">census_tract</span> <span class="op">=</span> <span class="num">8972720.3</span> <span class="com">#dummy placeholder</span>&nbsp;</span><span class="r"></span></p>
    <p id="t192" class="mis show_mis"><span class="n"><a href="#t192">192</a></span><span class="t">    <span class="nam">number_listings_census</span> <span class="op">=</span> <span class="num">40</span> <span class="com">#dummy placeholder</span>&nbsp;</span><span class="r"></span></p>
    <p id="t193" class="mis show_mis"><span class="n"><a href="#t193">193</a></span><span class="t">    <span class="nam">number_elderly_census</span> <span class="op">=</span> <span class="num">20</span> <span class="com">#dummy placeholder </span>&nbsp;</span><span class="r"></span></p>
    <p id="t194" class="mis show_mis"><span class="n"><a href="#t194">194</a></span><span class="t">    <span class="nam">number_single_parent_census</span> <span class="op">=</span> <span class="num">10</span> <span class="com">#dummy placeholder </span>&nbsp;</span><span class="r"></span></p>
    <p id="t195" class="mis show_mis"><span class="n"><a href="#t195">195</a></span><span class="t">    <span class="nam">rent_burden_census</span> <span class="op">=</span> <span class="str">"HIGH"</span> <span class="com">#low, medium, high</span>&nbsp;</span><span class="r"></span></p>
    <p id="t196" class="mis show_mis"><span class="n"><a href="#t196">196</a></span><span class="t">    <span class="nam">census_homeowners</span> <span class="op">=</span> <span class="num">33</span> <span class="com">#dummy placeholder</span>&nbsp;</span><span class="r"></span></p>
    <p id="t197" class="pln"><span class="n"><a href="#t197">197</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p id="t198" class="pln"><span class="n"><a href="#t198">198</a></span><span class="t">    <span class="com">#here we create the html text </span>&nbsp;</span><span class="r"></span></p>
    <p id="t199" class="mis show_mis"><span class="n"><a href="#t199">199</a></span><span class="t">    <span class="nam">html</span> <span class="op">=</span> <span class="str">"""</span>&nbsp;</span><span class="r"></span></p>
    <p id="t200" class="pln"><span class="n"><a href="#t200">200</a></span><span class="t"><span class="str">    &lt;!DOCTYPE html></span>&nbsp;</span><span class="r"></span></p>
    <p id="t201" class="pln"><span class="n"><a href="#t201">201</a></span><span class="t"><span class="str">&lt;html lang="en"></span>&nbsp;</span><span class="r"></span></p>
    <p id="t202" class="pln"><span class="n"><a href="#t202">202</a></span><span class="t"><span class="str">&lt;head></span>&nbsp;</span><span class="r"></span></p>
    <p id="t203" class="pln"><span class="n"><a href="#t203">203</a></span><span class="t"><span class="str">&lt;link href="http://fonts.googleapis.com/css?family=Lato:400,700,900" rel="stylesheet" type="text/css"></span>&nbsp;</span><span class="r"></span></p>
    <p id="t204" class="pln"><span class="n"><a href="#t204">204</a></span><span class="t"><span class="str">&lt;link href="static/ia_copy_tooltip.css" rel="stylesheet" type="text/css"></span>&nbsp;</span><span class="r"></span></p>
    <p id="t205" class="pln"><span class="n"><a href="#t205">205</a></span><span class="t"><span class="str">&lt;/head></span>&nbsp;</span><span class="r"></span></p>
    <p id="t206" class="pln"><span class="n"><a href="#t206">206</a></span><span class="t"><span class="str">&lt;div id="listingHover" class="pinned" style="left: 50px; visibility: visible; top: auto; bottom: 2px;"></span>&nbsp;</span><span class="r"></span></p>
    <p id="t207" class="pln"><span class="n"><a href="#t207">207</a></span><span class="t"><span class="str">    &lt;button type="button" class="close" data-dismiss="modal" aria-label="Close" id="closeHover" style="visibility: visible;">&lt;span aria-hidden="true">&#215;&lt;/span>&lt;/button></span>&nbsp;</span><span class="r"></span></p>
    <p id="t208" class="pln"><span class="n"><a href="#t208">208</a></span><span class="t"><span class="str">    &lt;div class="hostDetailsContainer"></span>&nbsp;</span><span class="r"></span></p>
    <p id="t209" class="pln"><span class="n"><a href="#t209">209</a></span><span class="t"><span class="str">        &lt;p>&lt;a id="listingHost" target="_blank" href="http://www.airbnb.com/users/show/{}">"""</span><span class="op">.</span><span class="nam">format</span><span class="op">(</span><span class="nam">host_id</span><span class="op">)</span> <span class="op">+</span> <span class="str">"""{}&lt;/a>"""</span><span class="op">.</span><span class="nam">format</span><span class="op">(</span><span class="nam">host_name</span><span class="op">)</span> <span class="op">+</span> <span class="str">""" ({}) &lt;/p>"""</span><span class="op">.</span><span class="nam">format</span><span class="op">(</span><span class="nam">host_location</span><span class="op">)</span> <span class="op">+</span> <span class="str">""" </span>&nbsp;</span><span class="r"></span></p>
    <p id="t210" class="pln"><span class="n"><a href="#t210">210</a></span><span class="t"><span class="str">        &lt;!-- want to say if have liscenese then show the number if not then say no liscnese illegal etc with django template can use if logic block --></span>&nbsp;</span><span class="r"></span></p>
    <p id="t211" class="pln"><span class="n"><a href="#t211">211</a></span><span class="t"><span class="str">        &lt;p id="listingHostLicense">&lt;span id="listingHostLicense">Hosting since: {}&lt;/span>"""</span><span class="op">.</span><span class="nam">format</span><span class="op">(</span><span class="nam">host_since</span><span class="op">)</span> <span class="op">+</span> <span class="str">"""&lt;/p></span>&nbsp;</span><span class="r"></span></p>
    <p id="t212" class="pln"><span class="n"><a href="#t212">212</a></span><span class="t"><span class="str">        &lt;p id="listingHostLicense">&lt;span id="listingHostLicense">{}&lt;/span>"""</span><span class="op">.</span><span class="nam">format</span><span class="op">(</span><span class="nam">license</span><span class="op">)</span> <span class="op">+</span> <span class="str">""" No License &lt;/p></span>&nbsp;</span><span class="r"></span></p>
    <p id="t213" class="pln"><span class="n"><a href="#t213">213</a></span><span class="t"><span class="str">        &lt;p id="listingHostCountContainer">(&lt;span id="listingHostListingCount">{}&lt;/span>"""</span><span class="op">.</span><span class="nam">format</span><span class="op">(</span><span class="nam">host_total_listings_count</span><span class="op">)</span> <span class="op">+</span> <span class="str">""" other listings locally)&lt;/p></span>&nbsp;</span><span class="r"></span></p>
    <p id="t214" class="pln"><span class="n"><a href="#t214">214</a></span><span class="t"><span class="str">        &lt;p id="listingHostCountContainerGlobal">(&lt;span id="listingHostListingCountGlobal">{}&lt;/span>"""</span><span class="op">.</span><span class="nam">format</span><span class="op">(</span><span class="nam">global_total_listings</span><span class="op">)</span> <span class="op">+</span> <span class="str">""" other listings globally)&lt;/p></span>&nbsp;</span><span class="r"></span></p>
    <p id="t215" class="pln"><span class="n"><a href="#t215">215</a></span><span class="t"><span class="str">    &lt;/div></span>&nbsp;</span><span class="r"></span></p>
    <p id="t216" class="pln"><span class="n"><a href="#t216">216</a></span><span class="t"><span class="str">    &lt;div class="listingDetailsContainer"></span>&nbsp;</span><span class="r"></span></p>
    <p id="t217" class="pln"><span class="n"><a href="#t217">217</a></span><span class="t"><span class="str">        &lt;p id="listingIDContainer">&lt;a id="listingID" target="_blank" href={}>"""</span><span class="op">.</span><span class="nam">format</span><span class="op">(</span><span class="nam">listing_url</span><span class="op">)</span> <span class="op">+</span> <span class="str">""" {}&lt;/a>"""</span><span class="op">.</span><span class="nam">format</span><span class="op">(</span><span class="nam">listing_id</span><span class="op">)</span> <span class="op">+</span> <span class="str">"""&lt;/p></span>&nbsp;</span><span class="r"></span></p>
    <p id="t218" class="pln"><span class="n"><a href="#t218">218</a></span><span class="t"><span class="str">        &lt;p id="listingNameContainer">&lt;a id="listingName" target="_blank" href={}>"""</span><span class="op">.</span><span class="nam">format</span><span class="op">(</span><span class="nam">listing_url</span><span class="op">)</span> <span class="op">+</span> <span class="str">"""{}&lt;/a>"""</span><span class="op">.</span><span class="nam">format</span><span class="op">(</span><span class="nam">listing_name</span><span class="op">)</span> <span class="op">+</span> <span class="str">"""&lt;/p></span>&nbsp;</span><span class="r"></span></p>
    <p id="t219" class="pln"><span class="n"><a href="#t219">219</a></span><span class="t"><span class="str">        &lt;p id="listingNeighbourhood">{}&lt;/p>"""</span><span class="op">.</span><span class="nam">format</span><span class="op">(</span><span class="nam">neighbourhood_cleansed</span><span class="op">)</span> <span class="op">+</span> <span class="str">"""</span>&nbsp;</span><span class="r"></span></p>
    <p id="t220" class="pln"><span class="n"><a href="#t220">220</a></span><span class="t"><span class="str">        &lt;p id="listingNeighbourhoodDistDuomo">{} meters to the Duomo&lt;/p>"""</span><span class="op">.</span><span class="nam">format</span><span class="op">(</span><span class="nam">dist_duomo</span><span class="op">)</span> <span class="op">+</span> <span class="str">"""</span>&nbsp;</span><span class="r"></span></p>
    <p id="t221" class="pln"><span class="n"><a href="#t221">221</a></span><span class="t"><span class="str">        &lt;p id="listingRoomType">{} ({} bedrooms, accommodates {})&lt;/p>"""</span><span class="op">.</span><span class="nam">format</span><span class="op">(</span><span class="nam">room_type</span><span class="op">,</span> <span class="nam">bedrooms</span><span class="op">,</span> <span class="nam">accommodates</span><span class="op">)</span> <span class="op">+</span> <span class="str">"""</span>&nbsp;</span><span class="r"></span></p>
    <p id="t222" class="pln"><span class="n"><a href="#t222">222</a></span><span class="t"><span class="str">    &lt;/div></span>&nbsp;</span><span class="r"></span></p>
    <p id="t223" class="pln"><span class="n"><a href="#t223">223</a></span><span class="t"><span class="str">    &lt;div id="listingPriceSection" class="listingSection"></span>&nbsp;</span><span class="r"></span></p>
    <p id="t224" class="pln"><span class="n"><a href="#t224">224</a></span><span class="t"><span class="str">        &lt;p class="listingSectionHeadlineContainer"></span>&nbsp;</span><span class="r"></span></p>
    <p id="t225" class="pln"><span class="n"><a href="#t225">225</a></span><span class="t"><span class="str">            &lt;span class="listingSectionHeadline">&lt;span class="dollarSign">&#8364;&lt;/span>&lt;span id="listingEstimatedIncomePerYear">{}&lt;/span>"""</span><span class="op">.</span><span class="nam">format</span><span class="op">(</span><span class="nam">rounded_revenue</span><span class="op">)</span> <span class="op">+</span> <span class="str">"""&lt;/span>&lt;span id="listingPriceLabel" class="listingSectionHeadlineLabel"> income/year (est.)&lt;/span></span>&nbsp;</span><span class="r"></span></p>
    <p id="t226" class="pln"><span class="n"><a href="#t226">226</a></span><span class="t"><span class="str">        &lt;/p></span>&nbsp;</span><span class="r"></span></p>
    <p id="t227" class="pln"><span class="n"><a href="#t227">227</a></span><span class="t"><span class="str">        &lt;p &lt;span class="listingSectionSubhead">&lt;span class="dollarSign">&#8364;&lt;/span>&lt;span id="listingEstimatedIncomePerMonth">{}&lt;/span>"""</span><span class="op">.</span><span class="nam">format</span><span class="op">(</span><span class="nam">monthly_rounded_revenue</span><span class="op">)</span> <span class="op">+</span> <span class="str">"""&lt;/span>&lt;span id="listingPriceLabel" class="listingSectionSubhead"> income/month (est.)&lt;/span> &lt;/p></span>&nbsp;</span><span class="r"></span></p>
    <p id="t228" class="pln"><span class="n"><a href="#t228">228</a></span><span class="t"><span class="str">        &lt;p class="listingSectionSubhead">&lt;span class="dollarSign">&#8364;&lt;/span>&lt;span id="listingPrice">{}&lt;/span>"""</span><span class="op">.</span><span class="nam">format</span><span class="op">(</span><span class="nam">price</span><span class="op">)</span> <span class="op">+</span> <span class="str">"""/night&lt;/p></span>&nbsp;</span><span class="r"></span></p>
    <p id="t229" class="pln"><span class="n"><a href="#t229">229</a></span><span class="t"><span class="str">        &lt;p class="listingSectionSubhead">&lt;span id="listingMinimumNights">{}&lt;/span>"""</span><span class="op">.</span><span class="nam">format</span><span class="op">(</span><span class="nam">night_min</span><span class="op">)</span> <span class="op">+</span> <span class="str">""" night minimum&lt;/p></span>&nbsp;</span><span class="r"></span></p>
    <p id="t230" class="pln"><span class="n"><a href="#t230">230</a></span><span class="t"><span class="str">    &lt;/div></span>&nbsp;</span><span class="r"></span></p>
    <p id="t231" class="pln"><span class="n"><a href="#t231">231</a></span><span class="t"><span class="str">    &lt;div id="listingReviewsSection" class="listingSection"></span>&nbsp;</span><span class="r"></span></p>
    <p id="t232" class="pln"><span class="n"><a href="#t232">232</a></span><span class="t"><span class="str">        &lt;p class="listingSectionHeadlineContainer"></span>&nbsp;</span><span class="r"></span></p>
    <p id="t233" class="pln"><span class="n"><a href="#t233">233</a></span><span class="t"><span class="str">            &lt;span class="listingSectionSubhead">&lt;span id="listingEstimatedNightsPerYear" class="listingSectionHeadline">{}&lt;/span>"""</span><span class="op">.</span><span class="nam">format</span><span class="op">(</span><span class="nam">days_rented</span><span class="op">)</span> <span class="op">+</span> <span class="str">"""&lt;span class="listingSectionHeadlineLabel"> nights/year (est.)&lt;/span>&lt;/span></span>&nbsp;</span><span class="r"></span></p>
    <p id="t234" class="pln"><span class="n"><a href="#t234">234</a></span><span class="t"><span class="str">        &lt;/p></span>&nbsp;</span><span class="r"></span></p>
    <p id="t235" class="pln"><span class="n"><a href="#t235">235</a></span><span class="t"><span class="str">        &lt;!-- &lt;p class="listingSectionSubhead">&lt;span id="listingEstimatedOccupancyRate">23.4&lt;/span>% occupancy rate (est.)&lt;/p> --></span>&nbsp;</span><span class="r"></span></p>
    <p id="t236" class="pln"><span class="n"><a href="#t236">236</a></span><span class="t"><span class="str">        &lt;p class="listingSectionSubhead">&lt;span id="listingReviewPerMonth">{}&lt;/span>"""</span><span class="op">.</span><span class="nam">format</span><span class="op">(</span><span class="nam">reviews_per_month</span><span class="op">)</span> <span class="op">+</span> <span class="str">""" reviews/month&lt;/p></span>&nbsp;</span><span class="r"></span></p>
    <p id="t237" class="pln"><span class="n"><a href="#t237">237</a></span><span class="t"><span class="str">        &lt;!-- &lt;p class="listingSectionSubhead">&lt;span id="listingNumberOfReviews">5&lt;/span>&lt;span id="listingReviewsLabel"> reviews&lt;/span>&lt;/p> --></span>&nbsp;</span><span class="r"></span></p>
    <p id="t238" class="pln"><span class="n"><a href="#t238">238</a></span><span class="t"><span class="str">        &lt;!-- &lt;p class="listingSectionSubhead">last: &lt;span id="listingLastReview">31/10/2021&lt;/span>&lt;/p> --></span>&nbsp;</span><span class="r"></span></p>
    <p id="t239" class="pln"><span class="n"><a href="#t239">239</a></span><span class="t"><span class="str">    &lt;/div></span>&nbsp;</span><span class="r"></span></p>
    <p id="t240" class="pln"><span class="n"><a href="#t240">240</a></span><span class="t"><span class="str">    &lt;div id="listingCensusSection" class= "listingSection"></span>&nbsp;</span><span class="r"></span></p>
    <p id="t241" class="pln"><span class="n"><a href="#t241">241</a></span><span class="t"><span class="str">    &lt;p class="listingSeciotnHeadlineContainer"></span>&nbsp;</span><span class="r"></span></p>
    <p id="t242" class="pln"><span class="n"><a href="#t242">242</a></span><span class="t"><span class="str">        &lt;span id="listingCensusInfo" class="listingSectionHeadline">{}&lt;/span>"""</span><span class="op">.</span><span class="nam">format</span><span class="op">(</span><span class="nam">rent_burden_census</span><span class="op">)</span> <span class="op">+</span> <span class="str">"""&lt;span class="listingSectionHeadlineLabel"> rent burden&lt;/span></span>&nbsp;</span><span class="r"></span></p>
    <p id="t243" class="pln"><span class="n"><a href="#t243">243</a></span><span class="t"><span class="str">    &lt;/p></span>&nbsp;</span><span class="r"></span></p>
    <p id="t244" class="pln"><span class="n"><a href="#t244">244</a></span><span class="t"><span class="str">    &lt;p class="listingSectionSubhead">&lt;span id="listingCensusId">Census Tract ID: {}&lt;/span>"""</span><span class="op">.</span><span class="nam">format</span><span class="op">(</span><span class="nam">census_tract</span><span class="op">)</span> <span class="op">+</span> <span class="str">"""&lt;/p></span>&nbsp;</span><span class="r"></span></p>
    <p id="t245" class="pln"><span class="n"><a href="#t245">245</a></span><span class="t"><span class="str">    &lt;p class="listingSectionSubhead">&lt;span id="listingHomeowner"> {}% of neighbors rent"""</span><span class="op">.</span><span class="nam">format</span><span class="op">(</span><span class="nam">census_homeowners</span><span class="op">)</span> <span class="op">+</span> <span class="str">"""% of block rents &lt;/span>&lt;/p></span>&nbsp;</span><span class="r"></span></p>
    <p id="t246" class="pln"><span class="n"><a href="#t246">246</a></span><span class="t"><span class="str">    &lt;p class="listingSectionSubhead">&lt;span id="listingCensusNumberListing"> {}"""</span><span class="op">.</span><span class="nam">format</span><span class="op">(</span><span class="nam">number_listings_census</span><span class="op">)</span> <span class="op">+</span> <span class="str">"""% of block is on airbnb&lt;/span>&lt;/p></span>&nbsp;</span><span class="r"></span></p>
    <p id="t247" class="pln"><span class="n"><a href="#t247">247</a></span><span class="t"><span class="str">    &lt;p class="listingSectionSubhead">&lt;span id="listingElderly"> {}"""</span><span class="op">.</span><span class="nam">format</span><span class="op">(</span><span class="nam">number_elderly_census</span><span class="op">)</span> <span class="op">+</span> <span class="str">"""% of neighbors are elderly&lt;/span>&lt;/p></span>&nbsp;</span><span class="r"></span></p>
    <p id="t248" class="pln"><span class="n"><a href="#t248">248</a></span><span class="t"><span class="str">    &lt;p class="listingSectionSubhead">&lt;span id="listingParent"> {}"""</span><span class="op">.</span><span class="nam">format</span><span class="op">(</span><span class="nam">number_single_parent_census</span><span class="op">)</span> <span class="op">+</span> <span class="str">"""% of neighbors are single parent&lt;/span>&lt;/p></span>&nbsp;</span><span class="r"></span></p>
    <p id="t249" class="pln"><span class="n"><a href="#t249">249</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p id="t250" class="pln"><span class="n"><a href="#t250">250</a></span><span class="t"><span class="str">    &lt;/div></span>&nbsp;</span><span class="r"></span></p>
    <p id="t251" class="pln"><span class="n"><a href="#t251">251</a></span><span class="t"><span class="str">    &lt;!-- &lt;div id="listingAvailabilitySection" class="listingSection"></span>&nbsp;</span><span class="r"></span></p>
    <p id="t252" class="pln"><span class="n"><a href="#t252">252</a></span><span class="t"><span class="str">        &lt;p class="listingSectionHeadlineContainer"></span>&nbsp;</span><span class="r"></span></p>
    <p id="t253" class="pln"><span class="n"><a href="#t253">253</a></span><span class="t"><span class="str">            &lt;span id="listingAvailabilityDescription" class="listingSectionHeadline">LOW&lt;/span>&lt;span class="listingSectionHeadlineLabel"> availability&lt;/span></span>&nbsp;</span><span class="r"></span></p>
    <p id="t254" class="pln"><span class="n"><a href="#t254">254</a></span><span class="t"><span class="str">        &lt;/p></span>&nbsp;</span><span class="r"></span></p>
    <p id="t255" class="pln"><span class="n"><a href="#t255">255</a></span><span class="t"><span class="str">        &lt;p class="listingSectionSubhead">&lt;span id="listingAvailability365">0&lt;/span> days/year (&lt;span id="listingAvailabilityPercentage">0&lt;/span>%)&lt;/p></span>&nbsp;</span><span class="r"></span></p>
    <p id="t256" class="pln"><span class="n"><a href="#t256">256</a></span><span class="t"><span class="str">    &lt;/div> --></span>&nbsp;</span><span class="r"></span></p>
    <p id="t257" class="pln"><span class="n"><a href="#t257">257</a></span><span class="t"><span class="str">    &lt;p class="listingSection">click listing on map to "pin" details&lt;/p></span>&nbsp;</span><span class="r"></span></p>
    <p id="t258" class="pln"><span class="n"><a href="#t258">258</a></span><span class="t"><span class="str">&lt;/div></span>&nbsp;</span><span class="r"></span></p>
    <p id="t259" class="pln"><span class="n"><a href="#t259">259</a></span><span class="t"><span class="str">&lt;/html></span>&nbsp;</span><span class="r"></span></p>
    <p id="t260" class="pln"><span class="n"><a href="#t260">260</a></span><span class="t"><span class="str">    """</span>&nbsp;</span><span class="r"></span></p>
    <p id="t261" class="mis show_mis"><span class="n"><a href="#t261">261</a></span><span class="t">    <span class="key">return</span> <span class="nam">html</span>&nbsp;</span><span class="r"></span></p>
    <p id="t262" class="pln"><span class="n"><a href="#t262">262</a></span><span class="t"><span class="com">#only need if running this as a script not importing</span>&nbsp;</span><span class="r"></span></p>
    <p id="t263" class="pln"><span class="n"><a href="#t263">263</a></span><span class="t"><span class="com"># def main():</span>&nbsp;</span><span class="r"></span></p>
    <p id="t264" class="pln"><span class="n"><a href="#t264">264</a></span><span class="t"><span class="com"># if __name__ == '__main__':</span>&nbsp;</span><span class="r"></span></p>
    <p id="t265" class="pln"><span class="n"><a href="#t265">265</a></span><span class="t"><span class="com">#     main()</span>&nbsp;</span><span class="r"></span></p>
    <p id="t266" class="pln"><span class="n"><a href="#t266">266</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
    <p id="t267" class="pln"><span class="n"><a href="#t267">267</a></span><span class="t">&nbsp;</span><span class="r"></span></p>
</div>
<div id="footer">
    <div class="content">
        <p>
            <a class="nav" href="index.html">&#xab; index</a> &nbsp; &nbsp; <a class="nav" href="https://coverage.readthedocs.io">coverage.py v5.2.1</a>,
            created at 2022-05-15 21:22 +0200
        </p>
    </div>
</div>
</body>
</html>
